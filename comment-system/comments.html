<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comment System</title>
    <link rel="stylesheet" href="styles-comments.css">
</head>
<body>
    <div class="root"></div>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script type="text/babel">
        function Comments() {
                const [comments, setComments] = React.useState([]);

                React.useEffect(() => {
                    fetch("https://jsonplaceholder.typicode.com/comments?postId=1")
                    .then(res => res.json())
                    .then(data => setComments(data))
                }, [])

                const handleSubmit = (event) => {
                    event.preventDefault();
                    const name = event.target.name.value;
                    const email = event.target.email.value;
                    const body = event.target.comment.value;

                    if (name && email && body) {
                        const infos = {
                            id: comments.length + 1,
                            name,
                            email,
                            body
                        }
                        setComments([infos, ...comments]);
                        event.target.name.value = "";
                        event.target.email.value = "";
                        event.target.comment.value = "";
                    }
                    else alert("You check the input if empty or invalid!")
                }
            return (
                <>
                    <div className = "comment-input">
                        <form id = "form" onSubmit = {(event) => {handleSubmit(event)}}>
                            <input type="text" id="name-user" name="name" placeholder = "Enter your name"/>
                            <input type="email" id="email" name="email" placeholder = "Enter your email"/>
                            <textarea id="comment-text" name="comment" placeholder = "Comment..."></textarea>
                            <button className = "btn-submit" type="submit">Send</button>
                        </form>
                    </div>
                    <div className = "comments-list">
                        {comments.map((item, index) => {
                            return (
                                <div className = "comment-item" key = {index}>
                                    <div className ="item-left">
                                       <img id = "img-avatar" src={`https://ui-avatars.com/api/?name=${item.name}&background=random`}/>
                                    </div>
                                    <div className = "item-body">
                                        <div className="item-infos">
                                            <p>{item.name}</p>
                                            <p>{item.email}</p>
                                        </div>
                                        <p>{item.body}</p>
                                    </div>
                                </div>
                            )
                        })}
                    </div>
                </>
            )
        }

        const app = (
            <div className = "container">
                <Comments />
            </div>
        )
        const root = ReactDOM.createRoot(document.querySelector(".root"));
        root.render(app);
    </script>
</body>
</html>